<!--solver.wxml-->
<view class="container">
  <!-- 顶部广告横幅 -->
  <view class="ad-banner">
    <view class="ad-content">
      <text class="ad-title">魔方还原助手</text>
      <text class="ad-subtitle">轻松几步，还原魔方</text>
    </view>
  </view>

  <!-- 分享按钮容器 -->
  <view class="share-container">
    <button class="share-btn" bindtap="shareSolution">
      <image src="/ui/share-icon.svg" class="share-icon"></image>
      <text class="share-text">分享给朋友</text>
    </button>
  </view>

  <!-- 魔方3D模型展示 -->
  <view class="cube-display">
    <hybrid-cube id="hybrid-cube" cubeState="{{cubeStateForDisplay}}" bind:cubeClick="onCubeClick" />
    
    <!-- 加载动画 -->
    <view class="solving-loading" wx:if="{{isSolving}}">
      <view class="loading-spinner"></view>
      <text>正在计算求解步骤...</text>
    </view>
  </view>

  <!-- 步数显示区域 -->
  <view class="step-info">
    <text class="step-text">步数：{{currentStep}}/{{totalSteps}}</text>
  </view>

  <!-- 底部控制区 -->
  <view class="bottom-controls">
    <!-- 主要控制按钮 -->
    <view class="main-controls">
      <button 
        class="control-btn back-btn" 
        bindtap="goBack"
      >
        返回
      </button>
      
      <button 
        class="control-btn nav-btn {{currentStep <= 0 ? 'btn-disabled' : ''}}" 
        bindtap="previousStep"
        disabled="{{currentStep <= 0 || isAnimating}}"
      >
        &lt;&lt;
      </button>
      
      <button 
        class="control-btn nav-btn {{currentStep >= totalSteps ? 'btn-disabled' : ''}}" 
        bindtap="nextStep"
        disabled="{{currentStep >= totalSteps || isAnimating}}"
      >
        &gt;&gt;
      </button>
      
      <button 
        class="control-btn auto-btn {{isAutoPlaying ? 'auto-playing' : ''}}" 
        bindtap="toggleAutoPlay"
      >
        自动
      </button>
    </view>

    <!-- 播放速度调节滑块 -->
    <view class="speed-control-section">
      <text class="speed-label">播放速度：</text>
      <view class="speed-options">
        <text class="speed-option {{playSpeed === 1 ? 'active' : ''}}" bindtap="setSpeed" data-speed="1">较慢</text>
        <text class="speed-option {{playSpeed === 2 ? 'active' : ''}}" bindtap="setSpeed" data-speed="2">慢速</text>
        <text class="speed-option {{playSpeed === 3 ? 'active' : ''}}" bindtap="setSpeed" data-speed="3">中速</text>
        <text class="speed-option {{playSpeed === 4 ? 'active' : ''}}" bindtap="setSpeed" data-speed="4">较快</text>
        <text class="speed-option {{playSpeed === 5 ? 'active' : ''}}" bindtap="setSpeed" data-speed="5">快速</text>
      </view>
    </view>
  </view>

  <!-- 完成提示 -->
  <view class="completion-card card" wx:if="{{isCompleted}}">
    <view class="completion-icon">🎉</view>
    <view class="completion-title">恭喜！魔方还原完成</view>
    <view class="completion-stats">
      <text>总步数：{{totalSteps}} 步</text>
      <text>用时：{{solveTime}}</text>
    </view>
    <button class="btn btn-primary" bindtap="startNew">开始新的还原</button>
  </view>
</view>

<!-- 分享对话框 -->
<view class="modal-overlay" wx:if="{{showShareModal}}" bindtap="hideShareModal">
  <view class="modal-content" catchtap="">
    <view class="modal-title">分享解法</view>
    <view class="share-options">
      <button class="btn btn-primary" bindtap="shareToFriend">分享给朋友</button>
      <button class="btn btn-secondary mt-10" bindtap="saveImage">保存图片</button>
    </view>
    <button class="btn btn-secondary mt-20" bindtap="hideShareModal">取消</button>
  </view>
</view>