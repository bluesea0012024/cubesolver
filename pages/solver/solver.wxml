<!--solver.wxml-->
<view class="container">
  <!-- 顶部广告位 -->
  <view class="ad-banner">
    <!-- 广告位预留 -->
    <text class="ad-placeholder">广告位</text>
  </view>

  <!-- 分享按钮 -->
  <view class="share-wrapper">
    <button class="share-btn" bindtap="shareSolution">
      <image class="share-icon" src="/ui/share-icon.png" mode="aspectFit"></image>
      <text>分享给朋友</text>
    </button>
  </view>

  <!-- 魔方3D模型展示 -->
  <view class="cube-display">
    <canvas 
      canvas-id="solverCanvas" 
      class="solver-canvas"
      bindtouchstart="onTouchStart"
      bindtouchmove="onTouchMove"
      bindtouchend="onTouchEnd"
    ></canvas>
    
    <!-- 加载动画 -->
    <view class="solving-loading" wx:if="{{isSolving}}">
      <view class="loading-spinner"></view>
      <text>正在计算求解步骤...</text>
    </view>
  </view>

  <!-- 步数显示 -->
  <view class="step-display">
    <text class="step-text">步数：{{currentStep}}/{{totalSteps}}</text>
  </view>

  <!-- 主要控制按钮 -->
  <view class="main-controls">
    <button 
      class="control-btn back-btn" 
      bindtap="goBack"
    >
      返回
    </button>
    
    <button 
      class="control-btn nav-btn {{currentStep <= 0 ? 'btn-disabled' : ''}}" 
      bindtap="previousStep"
      disabled="{{currentStep <= 0}}"
    >
      &lt;&lt;
    </button>
    
    <button 
      class="control-btn nav-btn {{currentStep >= totalSteps ? 'btn-disabled' : ''}}" 
      bindtap="nextStep"
      disabled="{{currentStep >= totalSteps}}"
    >
      &gt;&gt;
    </button>
  </view>

  <!-- 速度控制和自动播放 -->
  <view class="speed-auto-controls">
    <view class="speed-control">
      <text class="speed-label">{{speedText}}</text>
      <slider 
        class="speed-slider"
        min="1" 
        max="3" 
        step="1" 
        value="{{playSpeed}}"
        bindchange="onSpeedChange"
        activeColor="#4CAF50"
        backgroundColor="#e0e0e0"
      />
    </view>
    
    <button 
      class="auto-btn {{isAutoPlaying ? 'auto-playing' : ''}}" 
      bindtap="toggleAutoPlay"
    >
      自动
    </button>
  </view>

  <!-- 完成提示 -->
  <view class="completion-card card" wx:if="{{isCompleted}}">
    <view class="completion-icon">🎉</view>
    <view class="completion-title">恭喜！魔方还原完成</view>
    <view class="completion-stats">
      <text>总步数：{{totalSteps}} 步</text>
      <text>用时：{{solveTime}}</text>
    </view>
    <button class="btn btn-primary" bindtap="startNew">开始新的还原</button>
  </view>
</view>

<!-- 分享对话框 -->
<view class="modal-overlay" wx:if="{{showShareModal}}" bindtap="hideShareModal">
  <view class="modal-content" catchtap="">
    <view class="modal-title">分享解法</view>
    <view class="share-options">
      <button class="btn btn-primary" bindtap="shareToFriend">分享给朋友</button>
      <button class="btn btn-secondary mt-10" bindtap="saveImage">保存图片</button>
    </view>
    <button class="btn btn-secondary mt-20" bindtap="hideShareModal">取消</button>
  </view>
</view>